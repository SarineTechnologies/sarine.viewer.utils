/*
sarine.viewer.utils - v1.9.0 -  Thursday, March 10th, 2016, 10:11:58 AM 
*/
$(function(){return"undefined"==typeof utilsManager||utilsManager.IsMobile()?void 0:($.reject({reject:{msie:9},close:!1,header:"Your browser version is out of date",display:["chrome","safari","firefox","msie"],imagePath:"//d3n02ovm6tlpii.cloudfront.net/content/viewers/shell/v1/images/"}),"undefined"!=typeof vm&&vm.stop(),!1)}),function($){$.reject=function(options){var opts=$.extend(!0,{reject:{all:!1,msie:6},display:[],browserShow:!0,browserInfo:{chrome:{text:"Google Chrome",url:"http://www.google.com/chrome/"},firefox:{text:"Mozilla Firefox",url:"http://www.mozilla.com/firefox/"},safari:{text:"Safari",url:"http://www.apple.com/safari/download/"},opera:{text:"Opera",url:"http://www.opera.com/download/"},msie:{text:"Internet Explorer",url:"http://www.microsoft.com/windows/Internet-explorer/"}},header:"Did you know that your Internet Browser is out of date?",paragraph1:"Your browser is out of date, and may not be compatible with our website. A list of the most popular web browsers can be found below.",paragraph2:"Just click on the icons to get to the download page",close:!0,closeMessage:"By closing this window you acknowledge that your experience on this website may be degraded",closeLink:"Close This Window",closeURL:"#",closeESC:!0,closeCookie:!1,cookieSettings:{path:"/",expires:0},imagePath:"./images/",overlayBgColor:"#000",overlayOpacity:.8,fadeInTime:"fast",fadeOutTime:"fast",analytics:!1},options);opts.display.length<1&&(opts.display=["chrome","firefox","safari","opera","msie"]),$.isFunction(opts.beforeReject)&&opts.beforeReject(),opts.close||(opts.closeESC=!1);var browserCheck=function(settings){var layout=settings[$.layout.name],browser=settings[$.browser.name];return!!(settings.all||browser&&(browser===!0||$.browser.versionNumber<=browser)||settings[$.browser.className]||layout&&(layout===!0||$.layout.versionNumber<=layout)||settings[$.os.name])};if(!browserCheck(opts.reject))return $.isFunction(opts.onFail)&&opts.onFail(),!1;if(opts.close&&opts.closeCookie){var COOKIE_NAME="jreject-close",_cookie=function(name,value){if("undefined"!=typeof value){var expires="";if(0!==opts.cookieSettings.expires){var date=new Date;date.setTime(date.getTime()+1e3*opts.cookieSettings.expires),expires="; expires="+date.toGMTString()}var path=opts.cookieSettings.path||"/";return document.cookie=name+"="+encodeURIComponent(value?value:"")+expires+"; path="+path,!0}var cookie,val=null;if(document.cookie&&""!==document.cookie)for(var cookies=document.cookie.split(";"),clen=cookies.length,i=0;clen>i;++i)if(cookie=$.trim(cookies[i]),cookie.substring(0,name.length+1)==name+"="){var len=name.length;val=decodeURIComponent(cookie.substring(len+1));break}return val};if(_cookie(COOKIE_NAME))return!1}var html='<div id="jr_overlay"></div><div id="jr_wrap"><div id="jr_inner"><h1 id="jr_header">'+opts.header+"</h1>"+(""===opts.paragraph1?"":"<p>"+opts.paragraph1+"</p>")+(""===opts.paragraph2?"":"<p>"+opts.paragraph2+"</p>"),displayNum=0;if(opts.browserShow){html+="<ul>";for(var x in opts.display){var browser=opts.display[x],info=opts.browserInfo[browser]||!1;if(info&&(void 0==info.allow||browserCheck(info.allow))){var url=info.url||"#";html+='<li id="jr_'+browser+'"><div class="jr_icon"></div><div><a href="'+url+'">'+(info.text||"Unknown")+"</a></div></li>",++displayNum}}html+="</ul>"}html+='<div id="jr_close">'+(opts.close?'<a href="'+opts.closeURL+'">'+opts.closeLink+"</a><p>"+opts.closeMessage+"</p>":"")+"</div></div></div>";var element=$("<div>"+html+"</div>"),size=_pageSize(),scroll=_scrollSize();element.bind("closejr",function(){if(!opts.close)return!1;$.isFunction(opts.beforeClose)&&opts.beforeClose(),$(this).unbind("closejr"),$("#jr_overlay,#jr_wrap").fadeOut(opts.fadeOutTime,function(){$(this).remove(),$.isFunction(opts.afterClose)&&opts.afterClose()});var elmhide="embed.jr_hidden, object.jr_hidden, select.jr_hidden, applet.jr_hidden";return $(elmhide).show().removeClass("jr_hidden"),opts.closeCookie&&_cookie(COOKIE_NAME,"true"),!0});var analytics=function(url){if(!opts.analytics)return!1;var host=url.split(/\/+/g)[1];try{ga("send","event","External","Click",host,url)}catch(e){try{_gaq.push(["_trackEvent","External Links",host,url])}catch(e){}}},openBrowserLinks=function(url){return analytics(url),window.open(url,"jr_"+Math.round(11*Math.random())),!1};return element.find("#jr_overlay").css({width:size[0],height:size[1],background:opts.overlayBgColor,opacity:opts.overlayOpacity}),element.find("#jr_wrap").css({top:scroll[1]+size[3]/4,left:scroll[0]}),element.find("#jr_inner").css({minWidth:100*displayNum,maxWidth:140*displayNum,width:"trident"==$.layout.name?155*displayNum:"auto"}),element.find("#jr_inner li").css({background:'transparent url("'+opts.imagePath+'background_browser.gif") no-repeat scroll left top'}),element.find("#jr_inner li .jr_icon").each(function(){var self=$(this);self.css("background","transparent url("+opts.imagePath+"browser_"+self.parent("li").attr("id").replace(/jr_/,"")+".gif) no-repeat scroll left top"),self.click(function(){var url=$(this).next("div").children("a").attr("href");openBrowserLinks(url)})}),element.find("#jr_inner li a").click(function(){return openBrowserLinks($(this).attr("href")),!1}),element.find("#jr_close a").click(function(){return $(this).trigger("closejr"),"#"===opts.closeURL?!1:void 0}),$("#jr_overlay").focus(),$("embed, object, select, applet").each(function(){$(this).is(":visible")&&$(this).hide().addClass("jr_hidden")}),$("body").append(element.hide().fadeIn(opts.fadeInTime)),$(window).bind("resize scroll",function(){var size=_pageSize();$("#jr_overlay").css({width:size[0],height:size[1]});var scroll=_scrollSize();$("#jr_wrap").css({top:scroll[1]+size[3]/4,left:scroll[0]})}),opts.closeESC&&$(document).bind("keydown",function(event){27==event.keyCode&&element.trigger("closejr")}),$.isFunction(opts.afterReject)&&opts.afterReject(),!0};var _pageSize=function(){var xScroll=window.innerWidth&&window.scrollMaxX?window.innerWidth+window.scrollMaxX:document.body.scrollWidth>document.body.offsetWidth?document.body.scrollWidth:document.body.offsetWidth,yScroll=window.innerHeight&&window.scrollMaxY?window.innerHeight+window.scrollMaxY:document.body.scrollHeight>document.body.offsetHeight?document.body.scrollHeight:document.body.offsetHeight,windowWidth=window.innerWidth?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth,windowHeight=window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight;return[windowWidth>xScroll?xScroll:windowWidth,windowHeight>yScroll?windowHeight:yScroll,windowWidth,windowHeight]},_scrollSize=function(){return[window.pageXOffset?window.pageXOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollLeft:document.body.scrollLeft,window.pageYOffset?window.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop]}}(jQuery),function($){$.browserTest=function(a,z){var u="unknown",x="X",m=function(r,h){for(var i=0;i<h.length;i+=1)r=r.replace(h[i][0],h[i][1]);return r},c=function(i,a,b,c){var r={name:m((a.exec(i)||[u,u])[1],b)};if(r[r.name]=!0,r.opera?r.version=window.opera.version():r.version=(c.exec(i)||[x,x,x,x])[3],/safari/.test(r.name)){var safariversion=/(safari)(\/|\s)([a-z0-9\.\+]*?)(\;|dev|rel|\s|$)/,res=safariversion.exec(i);res&&res[3]&&res[3]<400&&(r.version="2.0")}else"presto"===r.name&&(r.version=$.browser.version>9.27?"futhark":"linear_b");if(/msie/.test(r.name)&&r.version===x){var ieVersion=/rv:(\d+\.\d+)/.exec(i);r.version=ieVersion[1]}r.versionNumber=parseFloat(r.version,10)||0;var minorStart=1;return r.versionNumber<100&&r.versionNumber>9&&(minorStart=2),r.versionX=r.version!==x?r.version.substr(0,minorStart):x,r.className=r.name+r.versionX,r};a=(/Opera|Navigator|Minefield|KHTML|Chrome|CriOS/.test(a)?m(a,[[/(Firefox|MSIE|KHTML,\slike\sGecko|Konqueror)/,""],["Chrome Safari","Chrome"],["CriOS","Chrome"],["KHTML","Konqueror"],["Minefield","Firefox"],["Navigator","Netscape"]]):a).toLowerCase(),$.browser=$.extend(z?{}:$.browser,c(a,/(camino|chrome|crios|firefox|netscape|konqueror|lynx|msie|trident|opera|safari)/,[["trident","msie"]],/(camino|chrome|crios|firefox|netscape|netscape6|opera|version|konqueror|lynx|msie|rv|safari)(:|\/|\s)([a-z0-9\.\+]*?)(\;|dev|rel|\s|$)/)),$.layout=c(a,/(gecko|konqueror|msie|trident|opera|webkit)/,[["konqueror","khtml"],["msie","trident"],["opera","presto"]],/(applewebkit|rv|konqueror|msie)(\:|\/|\s)([a-z0-9\.]*?)(\;|\)|\s)/),$.os={name:(/(win|mac|linux|sunos|solaris|iphone|ipad)/.exec(navigator.platform.toLowerCase())||[u])[0].replace("sunos","solaris")},z||$("html").addClass([$.os.name,$.browser.name,$.browser.className,$.layout.name,$.layout.className].join(" "))},$.browserTest(navigator.userAgent)}(jQuery),void 0!=window.performance&&void 0!=window.performance.now||(window.performance={},window.performance.now=function(){return performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){return(new Date).getTime()}}()),void 0==window.performance.mark&&(window.performance._marks=[],window.performance.mark=function(mark_name,duration){duration=duration||0,window.performance._marks.push({mark:mark_name,startTime:window.performance.now()-document.initTime,duration:duration})},window.performance.getEntriesByName=function(name){return window.performance._marks.filter(function(mark){return mark.mark==name})},window.performance.clearMarks=function(){},window.performance.clearMeasures=function(){},window.performance.measure=function(new_mark,start_mark_name,end_mark_name){if("undefined"!=typeof window.performance.getEntriesByName){var start_mark=window.performance.getEntriesByName(start_mark_name)[0],end_mark=window.performance.getEntriesByName(end_mark_name)[0];"undefined"!=typeof window.performance.mark&&("undefined"!=typeof start_mark&&"undefined"!=typeof end_mark?window.performance.mark(new_mark,end_mark.startTime-start_mark.startTime):window.performance.mark(new_mark,(new Date).getTime()-(new Date).getTime()))}}),document.initTime=performance.now(),window.performance.mark("mark_start");var startTime=Date.now(),performanceManager=function(isDebugMode){function formatTime(totalTime){return"undefined"!=typeof totalTime&&null!==totalTime?(totalTime/1e3).toFixed(3)+"s":void 0}function calcAndWriteToLog(id){var time=formatTime(calcTime(id));$("#"+id+">.value").html(time)}function measure(id,start,end){"undefined"!=typeof window.performance.measure&&window.performance.measure(id,start,end)}function mark(eventName){"undefined"!=typeof window.performance.mark&&window.performance.mark(eventName)}function newRelic(measure){if("undefined"!=typeof measure){var nr="undefined"!=typeof newrelic?newrelic:{addToTrace:function(obj){console.log(obj)},setCustomAttribute:function(name,value){console.log({name:name,value:value})}};Date.now();if(-1!=measure.name.indexOf("first_init")&&!firstInit&&window.performance){firstInit=!0,window.performance.measure("first_init","mark_start",measure.name+"_end");var m=window.performance.getEntriesByName("first_init")[0];nr.setCustomAttribute("first_init",m.duration+m.startTime)}return nr.addToTrace({name:measure.name,start:startTime,end:startTime+measure.startTime+measure.duration,origin:location.origin,type:measure.name.split("_").slice(2).join("-")}),nr.setCustomAttribute(measure.name.split("_").slice(2).join("-"),measure.duration),measure}}function callToGA(measure){if(window.gaUtils&&window.gaUtils.gaRun&&"undefined"!=typeof measure){var exp=measure.name.split("_").slice(2)[0],eventType=measure.name.split("_").slice(2).slice(1,3).join("-");["/vp",exp,eventType].join("/");window.gaUtils.gaRun("send","timing",exp,eventType,Math.round(measure.duration))}}function callToGaFel(measure){if(window.gaUtils&&window.gaUtils.gaRun&&"undefined"!=typeof measure&&-1!==measure.name.indexOf("experience")){var timingCategory=measure.name.split("-")[0],arr=measure.name.split("-"),timingVar=(arr.shift(),arr.join("-")),timingValue=Math.round(measure.duration),stoneCahce=getFromLocalStorage("stones",document.fel.stone),templateCahce=getFromLocalStorage("templates",document.fel.template),timingLabel=stoneCahce+"/"+templateCahce;1===location.hash.indexOf("debug")&&console.log("GA : timingCategory: "+timingCategory+", timingVar: "+timingVar+", timingValue: "+timingValue+", timingLabel: "+timingLabel),window.gaUtils.gaRun("send","timing",timingCategory,timingVar,timingValue,timingLabel),"last-experience-completed"===timingVar&&(addToLocalStorage("stones",document.fel.stone),addToLocalStorage("templates",document.fel.template))}}function getFromLocalStorage(type,value){var storedStr=null,storedArr=null,typeVal=type.substring(0,type.length-1),res="";return"undefined"!=typeof Storage&&null!==localStorage.getItem(type)&&(storedStr=localStorage.getItem(type),null!=storedStr&&(storedArr=JSON.parse(storedStr)),-1!==storedArr.indexOf(value)&&(res=typeVal+"-cached")),res}function addToLocalStorage(type,value){var stored;return"undefined"!=typeof Storage&&null!==localStorage.getItem(type)&&(stored=JSON.parse(localStorage.getItem(type)),-1===stored.indexOf(value))?(stored.push(value),localStorage.setItem(type,JSON.stringify(stored))):void 0}function calcTime(eventName){if("undefined"!=typeof window.performance.getEntriesByName){var measure=window.performance.getEntriesByName(eventName)[0];return measure.duration&&measure.startTime?(callToGA(measure),callToGaFel(measure),newRelic(measure)?measure.duration+measure.startTime:"N/A"):void 0}}function init(viewersArr){}var firstInit=!1;return isDebugMode?$("#debug_log").show():$("#debug_log").hide(),{Measure:measure,Mark:mark,CalcAndWriteToLog:calcAndWriteToLog,Init:init}}(1==location.hash.indexOf("debug"));$(document).on("loadTemplate",function(){vm&&performanceManager.Init(vm.getViewers())}),$(document).on("first_init_start",function(event,data){performanceManager.Mark(data.Id+"_first_init_start")}),$(document).on("first_init_end",function(event,data){var curExp=data.Id.split("_").slice(2)[0];curExp===document.fel.firstExp&&(performanceManager.Mark(curExp+"-first-init-end"),performanceManager.Measure(curExp+"-first-experience-preview","FEL-start",curExp+"-first-init-end"),performanceManager.CalcAndWriteToLog(curExp+"-first-experience-preview")),curExp===document.fel.lastExp&&(performanceManager.Mark(curExp+"-first-init-end"),performanceManager.Measure(curExp+"-last-experience-preview","FEL-start",curExp+"-first-init-end"),performanceManager.CalcAndWriteToLog(curExp+"-last-experience-preview")),performanceManager.Mark(data.Id+"_first_init_end"),performanceManager.Measure(data.Id+"_first_init",data.Id+"_first_init_start",data.Id+"_first_init_end"),performanceManager.CalcAndWriteToLog(data.Id+"_first_init")}),$(document).on("full_init_start",function(event,data){performanceManager.Mark(data.Id+"_full_init_start")}),$(document).on("full_init_end",function(event,data){var curExp=data.Id.split("_").slice(2)[0];curExp===document.fel.firstExp&&(performanceManager.Mark(curExp+"-full-init-end"),performanceManager.Measure(curExp+"-first-experience-completed","FEL-start",curExp+"-full-init-end"),performanceManager.CalcAndWriteToLog(curExp+"-first-experience-completed")),curExp===document.fel.lastExp&&(performanceManager.Mark(curExp+"-full-init-end"),performanceManager.Measure(curExp+"-last-experience-completed","FEL-start",curExp+"-full-init-end"),performanceManager.CalcAndWriteToLog(curExp+"-last-experience-completed")),performanceManager.Mark(data.Id+"_full_init_end"),performanceManager.Measure(data.Id+"_full_init",data.Id+"_full_init_start",data.Id+"_full_init_end"),performanceManager.CalcAndWriteToLog(data.Id+"_full_init")}),window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));var utilsManager=function(agent){function isMobile(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(_agent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(_agent.substr(0,4))}return _agent=agent,{IsMobile:isMobile}}(navigator.userAgent||navigator.vendor||window.opera);
//# sourceMappingURL=sarine.viewer.utils.min.js.map